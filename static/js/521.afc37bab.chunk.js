"use strict";(self.webpackChunkbnz_finances=self.webpackChunkbnz_finances||[]).push([[521],{348:function(e,t,r){r.r(t),r.d(t,{default:function(){return ce}});var n=r(885),o=r(413),s=r(791),i=r(172),a=r.n(i),u=r(422),l=r(67),c=r(664),d=r(184),f="\u20ac";function x(e){var t=e.toFixed(2).split("."),r=(0,n.Z)(t,2),o=r[0],s=r[1];return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("strong",{children:o}),",",(0,d.jsx)("span",{children:s}),f]})}var m=(0,s.createContext)([[],C]);function v(e){var t=e.children;return(0,s.useEffect)((function(){console.log("!!! ItemsProvider !!!")}),[]),(0,d.jsx)(m.Provider,{value:(0,s.useState)(JSON.parse("".concat(localStorage.getItem("data")))||[]),children:t})}function b(e){var t=(0,s.useContext)(m),r=(0,n.Z)(t,2),o=r[0],i=r[1],a=J(),u=a.type,l=a.sortByColors,c=a.sortBySum,d=a.sortByFavourites,f=a.sortByStrike,x=u,v="all"===e?o:o.filter((function(e){return e.type===x}));return l&&(v=Array.from(function(e,t){var r=new Map;return e.forEach((function(e){var n=t(e),o=r.get(n);o?o.push(e):r.set(n,[e])})),r}(v,(function(e){return e.color}))).map((function(e){return(0,n.Z)(e,2)[1]})).flat()),c&&(v=Array.from(v).sort((function(e,t){return t.sum-e.sum}))),d&&(v=v.filter((function(e){return e.star}))),f&&(v=v.filter((function(e){return!e.strike}))),[v,i]}function g(e){return(0,s.useContext)(m)[0].find((function(t){var r=t.id;return e===r}))}function p(e){localStorage.setItem("data",JSON.stringify(e))}var y=(0,s.forwardRef)((function(e,t){var r=e.id,n=e.className,o=g(r),s=o.title,i=o.sum,a=o.color,u=o.strike,l=o.star;return(0,d.jsxs)("div",{ref:t,className:(0,c.Z)(n,"flex border-t border-[var(--line-color)] w-full pl-7 pr-2 py-2","relative","after:absolute after:top-0.5 after:left-0 after:bottom-0.5","after:rounded-r","after:block after:w-1.5",a||""),children:[l&&(0,d.jsx)("div",{className:(0,c.Z)("absolute left-2.5 top-0 bottom-0","w-4","bg-[url('../public/assets/star-yellow.svg')]","bg-contain bg-center bg-no-repeat")}),(0,d.jsx)("div",{className:(0,c.Z)("text-xl flex items-center",u&&"line-through"),children:s}),(0,d.jsx)("code",{className:(0,c.Z)("flex-1 text-xl text-right",u&&"line-through"),children:x(i)})]})})),h={CARD:"card"};function j(e){var t=e.id,r=e.index,o=e.moveCard,i=(0,s.useRef)(null),a=(0,u.L)({accept:h.CARD,collect:function(e){return{handlerId:e.getHandlerId()}},hover:function(e,t){var n;if(i.current){var s=e.index,a=r;if(s!==a){var u=null===(n=i.current)||void 0===n?void 0:n.getBoundingClientRect(),l=(u.bottom-u.top)/2,c=t.getClientOffset().y-u.top;s<a&&c<l||s>a&&c>l||(o(s,a),e.index=a)}}}}),f=(0,n.Z)(a,2)[1],x=(0,l.c)({type:h.CARD,item:function(){return{id:t,index:r}},collect:function(e){return{isDragging:e.isDragging()}}}),m=(0,n.Z)(x,2),v=m[0].isDragging;return(0,m[1])(f(i)),(0,d.jsx)(y,{id:t,ref:i,className:(0,c.Z)("select-none cursor-move flex with-drag",v?"opacity-0":"opacity-100")})}var k=r(107),Z=function(e){return e[e.income=0]="income",e[e.outcome=1]="outcome",e}({});function N(){var e=b(),t=(0,n.Z)(e,2),r=t[0],o=t[1],i=(0,s.useCallback)((function(e,t){o((function(r){var n=a()(r,{$splice:[[e,1],[t,0,r[e]]]});return p(n),n}))}),[o]);return(0,d.jsx)("div",{className:k.n,children:r.map((function(e,t){var r=e.id;e.title,e.sum,e.color;return(0,d.jsx)(j,{index:t,id:r,moveCard:i},r)}))})}function C(){}var S={reorder:[!1,C,C],addNew:[!1,C,C],edit:[null,C,C],sortByColors:[!1,C,C],sortBySum:[!1,C,C],sortByFavourites:[!1,C,C],sortByStrike:[!1,C,C],menu:[!1,C,C],type:[Z.outcome,C,C]},B=(0,s.createContext)(S);function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return JSON.parse(localStorage.getItem("toggles")||JSON.stringify(e))}function F(e){localStorage.setItem("toggles",JSON.stringify((0,o.Z)((0,o.Z)({},w()),e)))}function I(e){var t=e.children,r=w({sortByColors:S.sortByColors[0],sortBySum:S.sortBySum[0],sortByFavourites:S.sortByFavourites[0],sortByStrike:S.sortByStrike[0],menu:S.menu[0],type:S.type[0]}),o=(0,s.useState)(S.reorder[0]),i=(0,n.Z)(o,2),a=i[0],u=i[1],l=(0,s.useState)(S.addNew[0]),c=(0,n.Z)(l,2),f=c[0],x=c[1],m=(0,s.useState)(S.edit[0]),v=(0,n.Z)(m,2),b=v[0],g=v[1],p=(0,s.useState)(r.sortByColors),y=(0,n.Z)(p,2),h=y[0],j=y[1],k=(0,s.useState)(r.sortBySum),N=(0,n.Z)(k,2),I=N[0],O=N[1],A=(0,s.useState)(r.sortByFavourites),J=(0,n.Z)(A,2),D=J[0],R=J[1],T=(0,s.useState)(r.sortByStrike),z=(0,n.Z)(T,2),L=z[0],P=z[1],V=(0,s.useState)(r.menu),M=(0,n.Z)(V,2),E=M[0],_=M[1],q=(0,s.useState)(r.type),H=(0,n.Z)(q,2),W=H[0],$=H[1],G={reorder:[a,u,(0,s.useCallback)((function(){u((function(e){return!e}))}),[u])],addNew:[f,x,(0,s.useCallback)((function(){x((function(e){return!e}))}),[x])],edit:[b,g,(0,s.useCallback)(C,[])],sortByColors:[h,j,(0,s.useCallback)((function(){j((function(e){return O(!1),R(!1),P(!1),F({sortByColors:!e,sortBySum:!1,sortByFavourites:!1,sortByStrike:!1}),!e}))}),[j,O,R,P])],sortBySum:[I,O,(0,s.useCallback)((function(){O((function(e){return j(!1),R(!1),P(!1),F({sortBySum:!e,sortByColors:!1,sortByFavourites:!1,sortByStrike:!1}),!e}))}),[j,O,R,P])],sortByFavourites:[D,R,(0,s.useCallback)((function(){R((function(e){return j(!1),O(!1),P(!1),F({sortByFavourites:!e,sortBySum:!1,sortByColors:!1,sortByStrike:!1}),!e}))}),[j,O,R,P])],sortByStrike:[L,P,(0,s.useCallback)((function(){P((function(e){return j(!1),O(!1),R(!1),F({sortByStrike:!e,sortByFavourites:!1,sortBySum:!1,sortByColors:!1}),!e}))}),[j,O,R,P])],menu:[E,_,(0,s.useCallback)((function(){_((function(e){return F({menu:!e}),!e}))}),[_])],type:[W,$,(0,s.useCallback)((function(){$((function(e){return e===Z.outcome?Z.income:Z.outcome}))}),[$])]};return(0,d.jsx)(B.Provider,{value:G,children:t})}function O(e){return(0,s.useContext)(B)[e]}function A(e){return(0,s.useContext)(B)[e][0]}function J(){var e=(0,s.useContext)(B),t={};return Object.keys(e).map((function(r){var n=r;return t[n]=e[n][0],n})),t}var D=r(90),R=r(401),T=r(355),z=(r(722),r(925));function L(e){var t=e.id,r=b(),o=(0,n.Z)(r,2)[1],i=(0,s.useCallback)((function(){o((function(e){var r=JSON.parse(JSON.stringify(e)),n=r.findIndex((function(e){return e.id===t}));return r.splice(n,1),p(r),r}))}),[o,t]);return(0,d.jsx)(T.SwipeAction,{destructive:!0,onClick:i,Tag:"div",children:(0,d.jsx)("button",{className:"bg-red-500 text-white font-bold px-2",children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})})}function P(e){var t=e.id,r=O("edit"),o=(0,n.Z)(r,2)[1],i=(0,s.useCallback)((function(){o((function(){return t}))}),[o,t]);return(0,d.jsx)(T.SwipeAction,{onClick:i,Tag:"div",children:(0,d.jsx)("button",{className:(0,c.Z)("bg-blue-500 text-white font-bold","px-2"),children:"\u0420\u0435\u0434\u0430\u043a."})})}function V(e){var t=e.id,r=b(),o=(0,n.Z)(r,2)[1],i=g(t).star,a=(0,s.useCallback)((function(){o((function(e){var r=JSON.parse(JSON.stringify(e)),n=r.findIndex((function(e){return e.id===t}));return r[n].star=!r[n].star,p(r),r}))}),[o,t]);return(0,d.jsx)(T.SwipeAction,{Tag:"div",onClick:a,children:(0,d.jsx)("button",{className:(0,c.Z)("!h-full bg-yellow-300 dark:bg-yellow-800 before:!top-0","icon",i?"star":"star-empty"),children:"\u0418\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435"})})}function M(e){var t=e.id,r=b(),o=(0,n.Z)(r,2)[1],i=(0,s.useCallback)((function(){o((function(e){var r=JSON.parse(JSON.stringify(e)),n=r.findIndex((function(e){return e.id===t}));return r[n].strike=!r[n].strike,p(r),r}))}),[o,t]);return(0,d.jsx)(T.SwipeAction,{Tag:"div",onClick:i,children:(0,d.jsx)("button",{className:"!h-full bg-red-200 dark:bg-red-800 before:!top-0 icon strike w-24",children:"\u0417\u0430\u0447\u0435\u0440\u043a\u043d\u0443\u0442\u044c"})})}var E=[null,"after:bg-red-500","after:bg-blue-500","after:bg-green-500","after:bg-yellow-500"];function _(e){var t=e.setData,r=e.onCancel,i=e.defaultValues,a=A("type"),u=(0,s.useState)({title:(null===i||void 0===i?void 0:i.title)||"",sum:(null===i||void 0===i?void 0:i.sum)||0,color:(null===i||void 0===i?void 0:i.color)||null,star:(null===i||void 0===i?void 0:i.star)||!1,strike:(null===i||void 0===i?void 0:i.strike)||!1}),l=(0,n.Z)(u,2),f=l[0],x=f.title,m=f.sum,v=f.color,b=f.strike,g=f.star,p=l[1],y=(0,s.useCallback)((function(e){e.preventDefault(),t({id:"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),title:x,sum:m,color:v,star:g,strike:b})}),[x,m,t,v,g,b]),h=a===Z.income?"bg-[var(--form-background-income)]":"bg-[var(--form-background-outcome)]";return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:(0,c.Z)("px-5 pt-3 flex gap-3",h,k.n,i?"":"rounded-t mt-2"),children:[E.map((function(e,t){return(0,d.jsx)("button",{onClick:function(){p((function(t){return(0,o.Z)((0,o.Z)({},t),{},{color:e})}))},className:(0,c.Z)("w-10 h-10 relative rounded","after:absolute after:inset-0 after:rounded",v===e&&"outline outline-2",e||(0,c.Z)("bg-center bg-no-repeat","bg-[url('../public/assets/cancel.svg')]","dark:bg-[url('../public/assets/cancel-dark.svg')]"))},t)})),(0,d.jsx)("button",{className:(0,c.Z)("ml-auto","w-10 h-10","icon strike","before:w-2/3 before:h-full before:top-0","rounded",b&&"outline"),onClick:function(){p((function(e){return(0,o.Z)((0,o.Z)({},e),{},{strike:!e.strike})}))}}),(0,d.jsx)("button",{className:(0,c.Z)("w-10 h-10","icon",g?"star-yellow":"star-empty","before:w-2/3 before:h-full before:top-0"),onClick:function(){p((function(e){return(0,o.Z)((0,o.Z)({},e),{},{star:!e.star})}))}})]}),(0,d.jsxs)("form",{onSubmit:y,className:(0,c.Z)("grid grid-cols-2","md:flex md:justify-end md:flex-row","p-5 gap-3",k.n,h,"rounded-b mb-2"),children:[(0,d.jsx)("input",{type:"text",className:"input col-span-2",placeholder:"\u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",autoFocus:!0,required:!0,defaultValue:x,onChange:function(e){p((function(t){return(0,o.Z)((0,o.Z)({},t),{},{title:e.target.value})}))}}),(0,d.jsx)("input",{type:"number",className:"input col-span-2",placeholder:"\u0441\u0443\u043c\u043c\u0430",min:0,step:.01,max:1e5,defaultValue:m,onChange:function(e){p((function(t){return(0,o.Z)((0,o.Z)({},t),{},{sum:Number(e.target.value)})}))}}),(0,d.jsx)("button",{type:"submit",className:"button order-2 md:order-1",children:i?"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c"}),r?(0,d.jsx)("button",{type:"button",className:"order-1 md:order-2",onClick:r,children:"\u041e\u0442\u043c\u0435\u043d\u0430"}):(0,d.jsx)("div",{className:"order-1 md:order-2"})]})]})}function q(e){var t=e.id,r=g(t),i=r.title,a=r.sum,u=r.color,l=r.strike,c=r.star,f=O("edit"),x=(0,n.Z)(f,2)[1],m=b(),v=(0,n.Z)(m,2)[1],y=(0,s.useCallback)((function(e){v((function(r){var n=JSON.parse(JSON.stringify(r)),s=n.findIndex((function(e){return e.id===t}));return n[s]=(0,o.Z)((0,o.Z)({},n[s]),{},{title:e.title,sum:e.sum,color:e.color,strike:e.strike,star:e.star}),p(n),n})),x(null)}),[v,t,x]);return(0,d.jsx)(_,{defaultValues:{title:i,sum:a,color:u,strike:l,star:c},setData:y,onCancel:function(){x(null)}})}var H=["itemId"];function W(e){var t=e.itemId,r=(0,z.Z)(e,H),n=J(),s=n.edit,i=n.type;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(T.SwipeableListItem,(0,o.Z)((0,o.Z)({},r),{},{maxSwipe:10,leadingActions:(0,d.jsxs)(T.LeadingActions,{children:[(0,d.jsx)(V,{id:t}),(0,d.jsx)(M,{id:t})]}),trailingActions:(0,d.jsxs)(T.TrailingActions,{children:[(0,d.jsx)(P,{id:t}),(0,d.jsx)(L,{id:t})]}),children:(0,d.jsx)(y,{id:t,className:(0,c.Z)("select-none",s===t&&(0,c.Z)("bg-[var(--form-background)] mt-2 rounded-t border-t-0",i===Z.income?"bg-[var(--form-background-income)]":"bg-[var(--form-background-outcome)]"))})})),s===t&&(0,d.jsx)(q,{id:t})]})}function $(){var e=b(),t=(0,n.Z)(e,1)[0],r=J(),o=r.addNew,s=r.sortByFavourites;return 0!==t.length||o?(0,d.jsx)(T.SwipeableList,{type:T.Type.IOS,className:k.n,children:t.map((function(e){var t=e.id;return(0,d.jsx)(W,{itemId:t},t)}))}):(0,d.jsx)("div",{className:"text-center py-4",children:s?(0,d.jsx)("div",{className:"icon star-yellow mx-auto whitespace-nowrap",children:"\u0432 \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u043c \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435\u0442"}):(0,d.jsx)(d.Fragment,{children:"\u043f\u0443\u0441\u0442\u043e"})})}function G(){var e=b("all"),t=(0,n.Z)(e,1)[0],r=(0,s.useMemo)((function(){return t.reduce((function(e,t){var r=t.type,n=t.sum;return r===Z.outcome&&(e[0]=e[0]+n),r===Z.income&&(e[1]=e[1]+n),e}),[0,0])}),[t]),o=(0,n.Z)(r,2),i=o[0],a=o[1];return(0,d.jsxs)("footer",{className:(0,c.Z)("relative",k.n,"border-t-4 border-[var(--line-color)]","bg-[var(--background-color-alt)]","sticky bottom-0"),children:[(0,d.jsxs)("div",{className:"flex w-full pl-7 pr-2 py-2",children:[(0,d.jsx)("div",{className:"text-xl flex items-center",children:"\u0414\u043e\u0445\u043e\u0434\u044b:"}),(0,d.jsx)("code",{className:"flex-1 text-xl text-right",children:x(a)})]}),(0,d.jsxs)("div",{className:"flex border-t border-[var(--line-color)] w-full pl-7 pr-2 py-2",children:[(0,d.jsx)("div",{className:"text-xl flex items-center",children:"\u0420\u0430\u0441\u0445\u043e\u0434\u044b:"}),(0,d.jsx)("code",{className:"flex-1 text-xl text-right",children:x(i)})]}),(0,d.jsxs)("div",{className:"flex border-t border-[var(--line-color)] w-full pl-7 pr-2 py-2",children:[(0,d.jsx)("div",{className:"text-xl flex items-center"}),(0,d.jsx)("code",{className:"flex-1 text-xl text-right",children:x(a-i)})]})]})}function K(){var e=b(),t=(0,n.Z)(e,1)[0],r=O("reorder"),o=(0,n.Z)(r,3),s=o[0],i=o[2],a=J(),u=a.sortByColors,l=a.sortBySum,f=a.addNew,x=a.edit,m=a.sortByFavourites,v=a.sortByStrike;return(0,d.jsx)("button",{disabled:t.length<=1||!!u||!!l||!!f||!!x||!!m||!!v,className:(0,c.Z)("icon",s?"confirm":"reorder"),onClick:i,children:s?"\u0413\u043e\u0442\u043e\u0432\u043e":"\u0420\u0435\u0434\u0430\u043a."})}function Q(){var e=b(),t=(0,n.Z)(e,1)[0],r=O("addNew"),o=(0,n.Z)(r,3),s=o[0],i=o[2];return(0,d.jsx)("button",{disabled:t.length<=0,className:(0,c.Z)("icon",s?"cancel":"add"),onClick:i,children:s?"\u041e\u0442\u043c\u0435\u043d\u0430":"\u041d\u043e\u0432\u044b\u0439"})}var U="shadow-inner bg-[var(--background-color-alt)]";function X(){var e=O("sortByColors"),t=(0,n.Z)(e,3),r=t[0],o=t[2];return(0,d.jsx)("button",{className:(0,c.Z)("rounded icon sort2",!!r&&U),onClick:o,children:"\u0426\u0432\u0435\u0442\u0430"})}function Y(){var e=O("sortBySum"),t=(0,n.Z)(e,3),r=t[0],o=t[2];return(0,d.jsx)("button",{className:(0,c.Z)("rounded icon sort1",!!r&&U),onClick:o,children:"\u0421\u0443\u043c."})}function ee(){var e=O("sortByFavourites"),t=(0,n.Z)(e,3),r=t[0],o=t[2];return(0,d.jsx)("button",{className:(0,c.Z)("rounded icon star",!!r&&U),onClick:o,children:"\u0418\u0437\u0431\u0440."})}function te(){var e=O("sortByStrike"),t=(0,n.Z)(e,3),r=t[0],o=t[2];return(0,d.jsx)("button",{className:(0,c.Z)("rounded icon strike ml-auto",!!r&&U),onClick:o,children:"\u0417\u0430\u0447\u0435\u0440\u043a."})}function re(){var e=A("menu");return(0,d.jsx)("div",{className:(0,c.Z)("overflow-hidden transition-[height] flex",k.n,"sticky top-14 bg-[var(--background-color)] shadow z-20",e?"h-20 py-3":"h-0"),children:e&&(0,d.jsx)(ne,{})})}function ne(){return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(Q,{}),(0,d.jsx)(K,{}),(0,d.jsx)(te,{}),(0,d.jsx)(ee,{}),(0,d.jsx)(X,{}),(0,d.jsx)(Y,{})]})}var oe=r(982);function se(){var e=b(),t=(0,n.Z)(e,2),r=t[0],s=t[1],i=O("addNew"),a=(0,n.Z)(i,3),u=a[0],l=a[1],c=a[2],f=J(),x=f.type,m=f.sortByFavourites,v=f.sortByStrike;return(0,d.jsx)(d.Fragment,{children:(u||r.length<=0)&&!m&&!v&&(0,d.jsx)(_,(0,o.Z)({setData:function(e){s((function(t){e.type=x;var r=[].concat((0,oe.Z)(t),[e]);return p(r),l(!1),r}))}},r.length<=0?{}:{onCancel:c}))})}function ie(e){var t=e.typeOfItem,r=e.title,o=O("type"),s=(0,n.Z)(o,2),i=s[0],a=s[1];return(0,d.jsx)("button",{onClick:function(){a(t),F({type:t})},className:(0,c.Z)("w-1/2 py-3",i===t&&"bg-[var(--background-color-alt)] font-bold"),children:r})}function ae(){var e=A("menu");return(0,d.jsxs)("div",{className:(0,c.Z)("flex sticky z-10","bg-[var(--background-color)]",e?"top-[136px]":"top-14",k.n),children:[(0,d.jsx)(ie,{title:"\u0420\u0430\u0441\u0445\u043e\u0434\u044b",typeOfItem:Z.outcome}),(0,d.jsx)(ie,{title:"\u0414\u043e\u0445\u043e\u0434\u044b",typeOfItem:Z.income})]})}function ue(){var e=O("menu"),t=(0,n.Z)(e,3),r=t[0],o=t[2];return(0,d.jsx)("button",{onClick:o,className:(0,c.Z)("absolute left-0 top-0 bottom-0 !p-0 !m-0","icon",r?"cancel":"menu","before:top-0 before:bottom-0 before:h-auto")})}function le(){var e=A("reorder");return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(k.h,{children:(0,d.jsx)(ue,{})}),(0,d.jsx)(re,{}),(0,d.jsx)(ae,{}),(0,d.jsx)("div",{className:"h-5"}),(0,d.jsx)(se,{}),e?(0,d.jsx)(D.W,{backend:R.PD,children:(0,d.jsx)(N,{})}):(0,d.jsx)($,{}),(0,d.jsx)("div",{className:"h-5"}),(0,d.jsx)(G,{})]})}function ce(){return(0,d.jsx)(I,{children:(0,d.jsx)(v,{children:(0,d.jsx)(le,{})})})}}}]);
//# sourceMappingURL=521.afc37bab.chunk.js.map